本章节是对可能用到的字段/属性的解释

> 赋值为null或者直接缺失键, 在用了`cloneId`的情况下表示继承`cloneId`物品的属性, 没有时表示缺失这个属性

# 类型解析

## common类型数据文件

```json
{
    "$type": "common", // 必须有
    "enable": false, // 修改后, 确定要添加后再改为true
    "baseInfo": {
        "id": "6900c8e93ea877662a000012", // 必须有, 且唯一
        ......
    },
    "propertyOverride": { // 可缺省，提供最全面的属性覆盖功能
        ......
    },
    "attributeInfo": { // 可缺省，封装了物品常用的一些属性
        ......
    },
    "buffsInfo": { // 可缺省，封装了食物/针剂的效果注册
        ......
    }
}
```

通用物品类型，除了`baseInfo`外其他修改数据都要写入`propertyOverride`字段

注意，当`baseInfo`中没有提供`cloneId`时，新物品的所有属性都来自于`propertyOverride`字段

**注意: id, $type必须提供; traderId不提供或提供有误时不会添加给商人; 其他属性都有默认值**

`propertyOverride`的数据类型为[TemplateItemProperties](https://github.com/sp-tarkov/server-csharp/blob/895d53262e32e2c6a7116048c1c85bfa7770a858/Libraries/SPTarkov.Server.Core/Models/Eft/Common/Tables/TemplateItem.cs#L71)

## drinkOrFood类型数据文件

在common已拥有的字段的基础上，额外拥有`drinkFoodInfo`字段

该字段可以设置食物使用时间，食物耐久量(特指饮品)，恢复或扣除的能量值/水分

## medical类型数据文件

在common已拥有的字段的基础上，额外拥有`medicalInfo`字段

提供了药品耐久/使用次数，生命回复速率，药品使用时间，药品效果生效类型，手术优先治疗部位等数据的封装

## ammo类型数据文件

在common已拥有的字段的基础上，额外拥有`ammoInfo`字段

提供了弹药类型，初始速度，弹头质量，基础伤害值，穿甲能力，对护甲伤害，破片概率，跳弹概率，流血相关伤害值，曳光弹相关数据，后坐散步等数据的封装

# 字段解析

## baseInfo字段

**注意: id必须提供; traderId不提供或提供有误时不会添加给商人; 其他属性都有默认值**(只有baseInfo有默认值)

`cloneId`和`handbookParentId`都没提供时, 是完全通过`propertyOverride`字段创建

```json
"baseInfo": {
    // 物品的唯一标识ID，使用24位十六进制字符串表示
    "id": "6900c8e93ea877662a000000",
    // 物品类型，与$type保持一致
    "type": "drinkOrDrugs",
    // 物品在游戏中显示的名称
    "name": "食物模板",
    // 物品描述，null表示使用默认描述或无描述
    "description": null,
    "locales": {
        "ch": {
            "name": "食物模板",
            "shortName": "食物模板(短)",
            "description": "一个食物模板"
        },
        "en": {
            "name": "Food Template",
            "shortName": "Food Template(Short)",
            "description": "A food template"
        }
    },
    // 作者名称
    "author": "Suntion",
    // 版权协议, 默认为MIT
    "license": "MIT",
    // 在本模组创建新物品时的加载顺序，数值越大加载越晚
    "order": 0,
    // 父级物品ID，用于继承基础属性(和cloneId物品的`_parent`一致)
    "parentId": "5448e8d04bdc2ddf718b4569",
    // 手册中的父级分类ID(必须和cloneId同时赋值)
    "handbookParentId": "5b47574386f77428ca22b336",
    // 复制的原型物品ID，基于该物品创建新物品(必须和handbookParentId同时赋值)
    "cloneId": "5448ff904bdc2d6f028b456e",
    // 默认售卖该物品的商人ID(默认null)
    "traderId": "54cb57776803fa99248b456e",
    // 跳蚤市场价格(默认1)
    "fleaPrice": 5000,
    // 手册价格(默认1)
    "handbookPrice": 5000,
    // 物品模型配置，null表示使用默认模型(null表示赋值cloneId后, 默认用cloneId的模型)
    "prefab": null,
    // 使用时的模型配置，null表示使用默认模型(null表示赋值cloneId后, 默认用cloneId的模型)
    "usePrefab": null,
    // 是否允许在跳蚤市场售卖(默认true)
    "CanSellOnRagfair": true
}
```

handbookParentId参考[handbookParentId 可选Id与对应类型](../常用常量/常用MongoId常量/handbookParentId 可选Id与对应类型.md)

traderId参考[商人Id](../常用常量/常用MongoId常量/商人Id.md)

## attributeInfo字段

```json
// 物品属性配置
"attributeInfo": {
    // 物品重量（千克）
    "weight": 0.3,
    // 物品在仓库中的宽度（格子数）
    "width": 3,
    // 物品在仓库中的高度（格子数）
    "height": 3,
    // PvE模式下的稀有度等级, 参考文末的常量, 字典里键/值都行
    "rarityPvE": "Common",
    // 丢弃限制，null表示继承克隆的物品的限制
    "discardLimit": null,
    // 物品操作音效类型, 参考下面的常量赋值
    "itemSound": "food_snack",
    // 最大堆叠数量，null表示继承克隆的物品的最大堆叠数量
    "stackMaxSize": null,
    // 是否默认已检视（无需再次检视）
    "examinedByDefault": true,
    // 检视所需时间（秒）
    "examineTime": 2,
    // 拾取时获得的经验值
    "lootExperience": 50,
    // 检视时获得的经验值
    "examineExperience": 500
}
```

rarityPvE参考[rarityPvE 稀有度](../常用常量/rarityPvE 稀有度.md)

itemSound参考[itemSound 可以赋值的值](../常用常量/itemSound 可以赋值的值.md)

## buffsInfo字段

这个字段是给食物/饮品/注射器的, 方便注册新buff

```json
// 增益效果配置
"buffsInfo": {
    // 兴奋剂效果配置，空字符串表示无兴奋剂效果
    "stimulatorBuffs": "",
    // 物品提供的增益效果列表，null表示无额外增益
    "buffs": null
}
```

有buff的示例:

**注意: 如果stimulatorBuffs赋值了唯一值, buffs赋值为null, 会导致无法注册buffs导致客户端出现问题**

```json
// Buff配置
"buffsInfo": {
    // 注册的buff名称
    "stimulatorBuffs": "BuffsStimulatorTpl",
    // 注册的buff, 如果为null, 会跳过注册; stimulatorBuffs已经被注册, 则使用
    "buffs": [
        {
            "AbsoluteValue": true,
            "BuffType": "HealthRate",
            "Chance": 1,
            "Delay": 1,
            "Duration": 300,
            "SkillName": "",
            "Value": 1
        },
        {
            "AbsoluteValue": true,
            "BuffType": "SkillRate",
            "Chance": 1,
            "Delay": 1,
            "Duration": 300,
            "SkillName": "Metabolism",
            "Value": 20
        }
    ]
}
````

## drinkDrugInfo字段

```json
// 食物/饮品配置
"drinkFoodInfo": {
  "foodUseTime": 5, // 使用时间
  "hydration": 33, // 水分变化量
  "energy": 33, // 能力变化量
  "maxResource": 20 // 最大资源(适合饮品)
}
```

## medicalInfo字段

不同药品写法不太一样, 参考我的模板赋值

```json
"medicalInfo": {
  "maxHpResource": null, // 最大治疗耐久
  "hpResourceRate": null, // 每次治疗消耗的耐久
  "medUseTime": null, // 药品使用时间
  "medEffectType": null, // 效果结算方式: duringUse 或 afterUse
  "effects_health": [], // 没有时为[], 有时为{}
  "effects_damage": [], // 没有时为[], 有时为{}
  "bodyPartPriority": [] // 手术包的优先治疗部位
}
```

## ammoInfo字段

```json
// 弹药属性配置
"ammoInfo": {
    "ammoType": "bullet",

    // 弹道初速（米/秒）
    "initialSpeed": 880.0,
    // 弹头质量（克）
    "bulletMassGram": 16.0,
    // 基础伤害值
    "damage": 80.0,
    // 穿透力（护甲等级）
    "penetrationPower": 35,
    // 对护甲的伤害系数
    "armorDamage": 0.6,

    // 碎裂几率（0.0-1.0）
    "fragmentationChance": 0.15,
    // 跳弹几率（0.0-1.0）
    "ricochetChance": 0.1,
    // 重流血几率增量
    "heavyBleedingDelta": 0.3,
    // 轻流血几率增量
    "lightBleedingDelta": 0.5,

    // 是否曳光弹
    "tracer": true,
    "tracerColor": "tracerRed",
    "caliber": "Caliber556x45NATO",
    // 霰弹子弹数量（仅霰弹有效）
    "buckshotBullets": 8,

    // 精度影响系数
    "ammoAccr": 0.0,
    // 后坐力影响系数
    "ammoRec": 0.0,
    // 射程影响系数
    "ammoDist": 0.0,
    // 每点伤害消耗的体力值
    "staminaBurnPerDamage": 0.5
}
```

tracerColor参考[tracerColor(曳光弹颜色)可用的值](../常用常量/子弹相关常量/tracerColor(曳光弹颜色)可用的值.md)

caliber参考[caliber(口径)可用的值](../常用常量/子弹相关常量/caliber(口径)可用的值.md)

## propertyOverride

完全照抄`游戏根目录\SPT\SPT_Data\database\templates\items.json`的物品的`_props`属性即可

类型为：[TemplateItemProperties](https://github.com/sp-tarkov/server-csharp/blob/895d53262e32e2c6a7116048c1c85bfa7770a858/Libraries/SPTarkov.Server.Core/Models/Eft/Common/Tables/TemplateItem.cs#L71)

## 不同类型支持的字段与示例

通用字段：**BaseInfo**(必须)、AttributeInfo、BuffsInfo、propertyOverride

> 继承自`NewItemCommon`的类型

| $type       | 支持的特殊字段    |
| ----------- | ----------------- |
| common      | 无                |
| drinkOrFood | **DrinkFoodInfo** |
| medical     | medicalInfo       |
| ammo        | ammoInfo          |



